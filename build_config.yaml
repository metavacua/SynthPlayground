# /build_config.yaml

build_groups:
  all:
    - protocols
    - knowledge-integrate
    - agents-md
  knowledge:
    - knowledge-integrate

targets:
  agents-md:
    compiler: tooling/master_agents_md_generator.py
    description: Generate the master AGENTS.md file.
    options:
      "--build-config": "build_config.yaml"
      "--knowledge-file": "knowledge_core/integrated_knowledge.jsonld"
    output: AGENTS.md
    sources:
      - "knowledge_core/integrated_knowledge.jsonld"
    type: compiler
  ast-generate:
    command: "python3 tooling/ast_generator.py"
    description: "Generate ASTs for all supported source files."
    type: command
  extract-symbols:
    command: "python3 tooling/symbol_extractor.py"
    description: "Extract symbols from ASTs to create a symbol map."
    type: command
  format:
    command: "python3 -m black tooling/"
    description: Format the code using black.
    type: command
  guardian-protocol:
    command: "python3 protocols/guardian/build.py"
    description: Compile the guardian protocol.
    type: command
  install:
    command: "pip install -r requirements.txt"
    description: Install Python dependencies.
    type: command
  knowledge-integrate:
    compiler: tooling/knowledge_integrator.py
    description: Integrate knowledge from various sources.
    output: "knowledge_core/integrated_knowledge.jsonld"
    sources:
      - "protocols.yaml-ld"
      # Add other knowledge sources here as they are created
    type: compiler
  lint:
    command: "python3 -m flake8 ."
    description: Lint the code using flake8.
    type: command
  protocols:
    compiler: tooling/protocol_compiler.py
    description: "Compile all protocol sources to a single YAML-LD file."
    output: "protocols.yaml-ld"
    sources:
      - "protocols/AGENTS.md"
      - "protocols/CHARTER.protocol.md"
      - "protocols/GIT_WORKFLOW_PROTOCOL.md"
      # Add other protocol files here
    type: compiler
  test:
    command: "python3 -m pytest"
    description: "Run the test suite using pytest."
    type: command
