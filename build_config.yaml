# /build_config.yaml

build_groups:
  all:
    - agents-md
    - protocols
    - knowledge-integrate
  knowledge:
    - knowledge-integrate

targets:
  agents-md:
    command: "python3 tooling/generate_agents_md.py"
    description: Generate the master AGENTS.md file.
    type: command
    dependencies:
      - lint-protocols
  lint-protocols:
    command: "python3 tooling/lint_chc_protocols.py"
    description: "Lint all CHC protocols to ensure they are well-formed."
    type: command
  ast-generate:
    command: "python3 tooling/ast_generator.py"
    description: "Generate ASTs for all supported source files."
    type: command
  extract-symbols:
    command: "python3 tooling/symbol_extractor.py"
    description: "Extract symbols from ASTs to create a symbol map."
    type: command
  remove-unused-imports:
    command: "python3 tooling/unused_import_remover.py --fix"
    description: "Remove unused imports from all Python files."
    type: command
  format:
    command: "python3 -m black tooling/"
    description: Format the code using black.
    type: command
  guardian-protocol:
    command: "python3 protocols/guardian/build.py"
    description: Compile the guardian protocol.
    type: command
  install:
    command: "pip install -r requirements.txt"
    description: Install Python dependencies.
    type: command
  knowledge-integrate:
    compiler: tooling/knowledge_integrator.py
    description: Integrate knowledge from various sources.
    output: "knowledge_core/integrated_knowledge.jsonld"
    sources:
      - "protocols.yaml-ld"
      # Add other knowledge sources here as they are created
    type: compiler
  lint:
    command: "python3 -m flake8 . --exclude=tree-sitter-python"
    description: Lint the code using flake8.
    type: command
  protocols:
    compiler: tooling/protocol_compiler.py
    description: "Compile all protocol sources to a single YAML-LD file."
    output: "protocols.yaml-ld"
    type: compiler
  test:
    command: "python3 -m pytest"
    description: "Run the test suite using pytest."
    type: command
  test-all:
    command: "python3 tooling/test_runner.py"
    description: "Run all tests in the repository."
    type: command
